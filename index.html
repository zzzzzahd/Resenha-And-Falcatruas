<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resenhas And Falcatruas</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Variáveis CSS para temas */
    :root {
      --bg-gradient-start: #667eea;
      --bg-gradient-end: #764ba2;
      --text-color: #333;
      --header-bg: rgba(255, 255, 255, 0.9);
      --header-border: rgba(255, 255, 255, 0.2);
      --card-bg: rgba(255, 255, 255, 0.95);
      --input-border: #ddd;
      --filter-btn-bg: #fff;
      --filter-btn-border: #ddd;
      --filter-btn-text: #333;
      --ranking-item-border: #eee;
      --music-player-bg: rgba(255, 255, 255, .95);
      --nav-btn-inactive-bg: rgba(255, 255, 255, 0.15);
      --nav-btn-inactive-text: #333;
    }

    /* Modo Escuro */
    body.dark-mode {
      --bg-gradient-start: #2d3748; /* Tom mais escuro de cinza azulado */
      --bg-gradient-end: #1a202c; /* Cinza bem escuro */
      --text-color: #f7fafc; /* Texto claro */
      --header-bg: rgba(26, 32, 44, 0.9); /* Header mais escuro */
      --header-border: rgba(255, 255, 255, 0.1);
      --card-bg: #2d3748; /* Card mais escuro */
      --input-border: #4a5568;
      --filter-btn-bg: #4a5568;
      --filter-btn-border: #4a5568;
      --filter-btn-text: #f7fafc;
      --ranking-item-border: #4a5568;
      --music-player-bg: rgba(26, 32, 44, .95);
      --nav-btn-inactive-bg: rgba(255, 255, 255, 0.1);
      --nav-btn-inactive-text: #f7fafc;
    }

    /* Estilos Gerais */
    * {margin:0;padding:0;box-sizing:border-box}
    body {
      font-family:'Segoe UI',sans-serif;
      background:linear-gradient(135deg,var(--bg-gradient-start) 0%,var(--bg-gradient-end) 100%);
      min-height:100vh;
      color:var(--text-color);
      transition:background 0.3s ease, color 0.3s ease; /* Transição suave para o tema */
    }
    .header {
      background:var(--header-bg);
      backdrop-filter:blur(15px);
      border-bottom:1px solid var(--header-border);
      box-shadow:0 4px 12px rgba(0,0,0,.1);
      padding:15px;position:sticky;top:0;z-index:10;
      transition:background 0.3s ease, border-color 0.3s ease;
    }
    .header-content {max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between}
    .logo {font-size:24px;font-weight:700;background:linear-gradient(135deg,#e11d48,#be185d);-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:flex;align-items:center;gap:8px}
    .status-badge {background:linear-gradient(135deg,#10b981,#059669);color:#fff;padding:5px 12px;border-radius:15px;font-size:12px;font-weight:600;margin-left:10px}
    .nav-buttons {display:flex;gap:8px}
    .nav-btn {
      padding:10px 18px;border:none;border-radius:20px;
      background:var(--nav-btn-inactive-bg);
      backdrop-filter:blur(10px);
      cursor:pointer;font-weight:600;transition:.3s;display:flex;align-items:center;gap:6px;
      color: var(--nav-btn-inactive-text);
      transition: background 0.3s ease, color 0.3s ease;
    }
    .nav-btn.active,.nav-btn:hover {background:linear-gradient(135deg,#1f2937,#4b5563);color:#fff}
    
    /* Botão de tema */
    .theme-toggle {
        background: var(--nav-btn-inactive-bg);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        cursor: pointer;
        color: var(--nav-btn-inactive-text);
        margin-left: 10px;
        transition: background 0.3s ease, color 0.3s ease;
    }
    .theme-toggle:hover {
        background: linear-gradient(135deg, #1f2937, #4b5563);
        color: #fff;
    }
    .theme-toggle i {
        pointer-events: none; /* Evita que o ícone capture cliques */
    }

    .container {max-width:1200px;margin:20px auto;padding:10px}
    .stats {display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:20px}
    .stat-card {
      background:var(--card-bg);
      border-radius:15px;padding:20px;text-align:center;box-shadow:0 5px 15px rgba(0,0,0,.1);
      transition:background 0.3s ease;
    }
    .stat-number {font-size:24px;font-weight:700;background:linear-gradient(135deg,#e11d48,#be185d);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:5px}
    .form-box {
      background:var(--card-bg);
      border-radius:15px;padding:25px;margin-bottom:25px;box-shadow:0 5px 15px rgba(0,0,0,.1);
      transition:background 0.3s ease;
    }
    h2 {color:var(--text-color); transition: color 0.3s ease;} /* Ajusta a cor do título h2 */

    .form-row {display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-bottom:15px}
    .input {
      padding:12px;border:2px solid var(--input-border);border-radius:10px;font-size:14px;
      background: var(--card-bg); /* Garante que o input tenha o bg do card no modo escuro */
      color: var(--text-color);
      transition: border-color 0.3s ease, background 0.3s ease, color 0.3s ease;
    }
    .input:focus {border-color:#e11d48;outline:none}
    .btn {background:linear-gradient(135deg,#e11d48,#be185d);color:#fff;padding:12px 24px;border:none;border-radius:20px;font-weight:600;cursor:pointer;transition:.3s}
    .btn:hover {box-shadow:0 6px 20px rgba(225,29,72,.4);transform:translateY(-2px)}
    .filters {margin-bottom:20px;display:flex;flex-wrap:wrap;gap:10px}
    .filter-btn {
      padding:8px 16px;border-radius:20px;border:1px solid var(--filter-btn-border);
      background:var(--filter-btn-bg);cursor:pointer;font-weight:600;transition:.3s;
      color: var(--filter-btn-text);
      transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    }
    .filter-btn.active,.filter-btn:hover {background:#e11d48;color:#fff;border-color:#e11d48}
    .cards {display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px}
    .card {
      background:var(--card-bg);
      border-radius:15px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.1);position:relative;
      transition:background 0.3s ease;
    }
    .card.ativa {border-left:5px solid #10b981}
    .card.encerrada {border-left:5px solid #ef4444;opacity:.9}
    .status-tag {position:absolute;top:12px;right:12px;padding:4px 10px;font-size:11px;border-radius:12px;font-weight:600}
    .status-ativa {background:#d1fae5;color:#065f46}
    .status-encerrada {background:#fee2e2;color:#991b1b}
    .card-buttons {margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
    .card-btn {flex:1;padding:10px;border:none;border-radius:12px;cursor:pointer;font-weight:600;transition:.3s}
    .card-btn:hover {transform:translateY(-2px)}
    .ranking-section {display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:15px;margin-top:20px}
    .ranking-card {
      background:var(--card-bg);
      border-radius:15px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.1);
      transition:background 0.3s ease;
    }
    .ranking-item {
      display:flex;justify-content:space-between;align-items:center;padding:8px 0;
      border-bottom:1px solid var(--ranking-item-border);
      transition:border-color 0.3s ease;
    }
    .ranking-item:last-child{border-bottom:none}
    .ranking-pos {width:22px;height:22px;border-radius:50%;color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;margin-right:6px}
    .ranking-pos-1 {background:linear-gradient(135deg,#FFD700,#FFA500)}
    .ranking-pos-2 {background:linear-gradient(135deg,#C0C0C0,#A9A9A9)}
    .ranking-pos-3 {background:linear-gradient(135deg,#CD7F32,#8C6B46)}
    .music-player {
      position:fixed;bottom:15px;right:15px;
      background:var(--music-player-bg);
      padding:10px 15px;border-radius:30px;box-shadow:0 4px 10px rgba(0,0,0,.2);display:flex;align-items:center;gap:10px;
      transition:background 0.3s ease;
    }
    .music-btn {background:none;border:none;color:#e11d48;font-size:18px;cursor:pointer}
    .music-title {font-size:13px;font-weight:600;color:var(--text-color);max-width:160px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:color 0.3s ease;}
    
    /* Media Queries para responsividade (opcional, mas boa prática) */
    @media (max-width: 768px) {
        .header-content {flex-wrap: wrap; justify-content: center;}
        .nav-buttons {width: 100%; justify-content: center; margin-top: 10px;}
        .logo {margin-bottom: 10px;}
        .theme-toggle {margin-left: 0; margin-top: 10px;}
        .form-row {grid-template-columns: 1fr;}
        .cards, .ranking-section {grid-template-columns: 1fr;}
    }
  </style>
</head>
<body class="light-mode"> 
  <div class="header">
    <div class="header-content">
      <div class="logo"><i class="fas fa-dice"></i> Resenhas And Falcatruas <span id="status-badge" class="status-badge">Conectando...</span></div>
      <div style="display: flex; align-items: center;">
        <div class="nav-buttons">
          <button class="nav-btn active" onclick="showPage('apostas')"><i class="fas fa-coins"></i> Apostas</button>
          <button class="nav-btn" onclick="showPage('ranking')"><i class="fas fa-trophy"></i> Ranking</button>
          <button class="nav-btn" onclick="showPage('regras')"><i class="fas fa-book"></i> Regras</button>
        </div>
        
        <button id="theme-toggle-btn" class="theme-toggle">
            <i class="fas fa-moon"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="container">
    <div id="apostas-page">
      <div class="stats">
        <div class="stat-card"><span id="total-apostas" class="stat-number">0</span><span>Total</span></div>
        <div class="stat-card"><span id="apostas-ativas" class="stat-number">0</span><span>Ativas</span></div>
        <div class="stat-card"><span id="apostas-encerradas" class="stat-number">0</span><span>Encerradas</span></div>
        <div class="stat-card"><span id="valor-total" class="stat-number">R$0</span><span>Valor Total</span></div>
      </div>

      <div class="form-box">
        <h2><i class="fas fa-plus-circle"></i> Nova Aposta</h2>
        <div class="form-row">
          <input id="ap1" class="input" placeholder="Apostador 1*">
          <input id="ap2" class="input" placeholder="Apostador 2*">
          <input id="desc" class="input" placeholder="Descrição*">
          <input id="val" class="input" placeholder="Valor*">
          <input id="obs" class="input" placeholder="Observações">
        </div>
        <button class="btn" onclick="createBet()">Adicionar Aposta</button>
      </div>

      <div class="filters">
        <button id="filter-todas" class="filter-btn active" onclick="filterBets('todas')">Todas</button>
        <button id="filter-ativas" class="filter-btn" onclick="filterBets('ativa')">Ativas</button>
        <button id="filter-encerradas" class="filter-btn" onclick="filterBets('encerrada')">Encerradas</button>
      </div>

      <div class="cards" id="lista-apostas"></div>
    </div>

    <div id="ranking-page" style="display:none">
      <h2><i class="fas fa-trophy"></i> Ranking</h2>
      <div class="ranking-section">
        <div class="ranking-card"><h3>Ranking do Mês</h3><div id="monthly-winners"></div></div>
        <div class="ranking-card"><h3>Ranking do Ano</h3><div id="yearly-winners"></div></div>
        <div class="ranking-card"><h3>Quem Mais Perdeu (Mês)</h3><div id="monthly-losers"></div></div>
        <div class="ranking-card"><h3>Quem Mais Perdeu (Ano)</h3><div id="yearly-losers"></div></div>
      </div>
    </div>

    <div id="regras-page" style="display:none">
      <h2 style="color:#dc2626"><i class="fas fa-gavel"></i> Regras</h2>
      <ul style="list-style:none;margin-top:15px">
        <li><b>Regra 1:</b> Presepou pra pagar é o dobro...</li>
        <li><b>Regra 2:</b> Cancelar aposta paga cashout...</li>
        <li><b>Regra 3:</b> Apostas encerradas ficam salvas...</li>
        <li><b>Regra 4:</b> Apenas admin define vencedor...</li>
      </ul>
    </div>
  </div>

  <div class="music-player">
    <button id="play-pause-btn" class="music-btn"><i class="fas fa-play"></i></button>
    <div id="music-title" class="music-title">Música de Fundo</div>
  </div>
  <audio id="bg-music" loop preload="auto">
    <source src="bg-music.mp3" type="audio/mp3">
  </audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-app-compat.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-database-compat.min.js"></script>
<script>
  const firebaseConfig={apiKey:"AIzaSyBxYWK7bLY9gjpMZbC8O6vwZp0VGPFIFfU",authDomain:"resenha-and-falcatruas.firebaseapp.com",databaseURL:"https://resenha-and-falcatruas-default-rtdb.firebaseio.com",projectId:"resenha-and-falcatruas",storageBucket:"resenha-and-falcatruas.firebasestorage.app",messagingSenderId:"865007454734",appId:"1:865007454734:web:7e22573f904d4b68744a5f"};
  firebase.initializeApp(firebaseConfig);
  const db=firebase.database();
  let bets=[];let currentFilter='todas';

  function showPage(page){document.getElementById('apostas-page').style.display='none';document.getElementById('ranking-page').style.display='none';document.getElementById('regras-page').style.display='none';document.querySelectorAll('.nav-btn').forEach(btn=>btn.classList.remove('active'));if(page==='apostas'){document.getElementById('apostas-page').style.display='block';document.querySelectorAll('.nav-btn')[0].classList.add('active');}if(page==='ranking'){document.getElementById('ranking-page').style.display='block';document.querySelectorAll('.nav-btn')[1].classList.add('active');calculateRankings();}if(page==='regras'){document.getElementById('regras-page').style.display='block';document.querySelectorAll('.nav-btn')[2].classList.add('active');}}

  function createBet(){const ap1=document.getElementById('ap1').value.trim();const ap2=document.getElementById('ap2').value.trim();const desc=document.getElementById('desc').value.trim();const val=document.getElementById('val').value.trim();const obs=document.getElementById('obs').value.trim();if(!ap1||!ap2||!desc||!val){alert('Preencha todos os campos obrigatórios!');return;}const newBet={id:Date.now(),ap1,ap2,desc,val,obs,status:'ativa',data:new Date().toLocaleDateString('pt-BR'),vencedor:null};db.ref('apostas/'+newBet.id).set(newBet);document.getElementById('ap1').value=document.getElementById('ap2').value=document.getElementById('desc').value=document.getElementById('val').value=document.getElementById('obs').value='';}

  function filterBets(type){currentFilter=type;document.querySelectorAll('.filter-btn').forEach(btn=>btn.classList.remove('active'));document.getElementById('filter-'+(type==='todas'? 'todas':type+'s')).classList.add('active');renderBets();}

  function renderBets(){const container=document.getElementById('lista-apostas');container.innerHTML='';let filtered=bets;if(currentFilter!=='todas'){filtered=bets.filter(b=>b.status===currentFilter);}if(filtered.length===0){container.innerHTML='<div>Nenhuma aposta encontrada.</div>';return;}filtered.sort((a,b)=>b.id-a.id);filtered.forEach(bet=>{const div=document.createElement('div');div.className='card '+bet.status;div.innerHTML=`<div class="status-tag status-${bet.status}">${bet.status}</div><h3>${bet.ap1} <span class="vs">VS</span> ${bet.ap2}</h3><p>${bet.desc}</p><div><b>R$${bet.val}</b></div>${bet.obs?'<div>'+bet.obs+'</div>':''}${bet.vencedor?'<div>🏆 '+bet.vencedor+'</div>':''}<div class="card-buttons">${bet.status==='ativa'?`<button class="card-btn" style="background:#10b981;color:#fff" onclick="endBet('${bet.id}','${bet.ap1}')">${bet.ap1}</button><button class="card-btn" style="background:#10b981;color:#fff" onclick="endBet('${bet.id}','${bet.ap2}')">${bet.ap2}</button>`:''}<button class="card-btn" style="background:#ef4444;color:#fff" onclick="deleteBet('${bet.id}')">Excluir</button></div>`;container.appendChild(div);});updateStats();}

  function updateStats(){document.getElementById('total-apostas').textContent=bets.length;document.getElementById('apostas-ativas').textContent=bets.filter(b=>b.status==='ativa').length;document.getElementById('apostas-encerradas').textContent=bets.filter(b=>b.status==='encerrada').length;let valorTotal=0;bets.forEach(b=>valorTotal+=parseFloat(b.val)||0);document.getElementById('valor-total').textContent='R$'+valorTotal;}

  function endBet(id,winner){db.ref('apostas/'+id).update({status:'encerrada',vencedor:winner});}
  function deleteBet(id){db.ref('apostas/'+id).remove();}

  db.ref('apostas').on('value',snap=>{const data=snap.val();bets=data?Object.values(data):[];renderBets();if(document.getElementById('ranking-page').style.display==='block'){calculateRankings();}});

  function calculateRankings(){
    const now = new Date();
    const currentMonth = now.getMonth();
    const currentYear = now.getFullYear();

    const monthlyWinners = {};
    const yearlyWinners = {};
    const monthlyLosers = {};
    const yearlyLosers = {};

    bets.forEach(bet => {
        if (bet.status === 'encerrada' && bet.vencedor) {
            const betDateParts = bet.data.split('/');
            const betDate = new Date(`${betDateParts[2]}-${betDateParts[1]}-${betDateParts[0]}`);

            if (betDate.getMonth() === currentMonth && betDate.getFullYear() === currentYear) {
                monthlyWinners[bet.vencedor] = (monthlyWinners[bet.vencedor] || 0) + parseFloat(bet.val);
                const perdedor = bet.vencedor === bet.ap1 ? bet.ap2 : bet.ap1;
                monthlyLosers[perdedor] = (monthlyLosers[perdedor] || 0) + parseFloat(bet.val);
            }
            if (betDate.getFullYear() === currentYear) {
                yearlyWinners[bet.vencedor] = (yearlyWinners[bet.vencedor] || 0) + parseFloat(bet.val);
                const perdedor = bet.vencedor === bet.ap1 ? bet.ap2 : bet.ap1;
                yearlyLosers[perdedor] = (yearlyLosers[perdedor] || 0) + parseFloat(bet.val);
            }
        }
    });

    renderRanking(monthlyWinners, 'monthly-winners', 'Vencedor do Mês');
    renderRanking(yearlyWinners, 'yearly-winners', 'Vencedor do Ano');
    renderRanking(monthlyLosers, 'monthly-losers', 'Perdedor do Mês');
    renderRanking(yearlyLosers, 'yearly-losers', 'Perdedor do Ano');
  }

  function renderRanking(data, elementId, title) {
    const element = document.getElementById(elementId);
    element.innerHTML = '';
    const sorted = Object.entries(data).sort(([, valA], [, valB]) => valB - valA).slice(0, 3);
    
    if (sorted.length === 0) {
        element.innerHTML = '<p>Nenhum resultado.</p>';
        return;
    }

    sorted.forEach(([apostador, valor], index) => {
        const div = document.createElement('div');
        div.className = 'ranking-item';
        const positionClass = 'ranking-pos-' + (index + 1);
        div.innerHTML = `
            <div style="display: flex; align-items: center;">
                <span class="ranking-pos ${positionClass}">${index + 1}</span>
                <span>${apostador}</span>
            </div>
            <span>R$${valor.toFixed(2)}</span>
        `;
        element.appendChild(div);
    });
  }
</script>

<script>
  // Script para música de fundo
  const playPauseBtn = document.getElementById('play-pause-btn');
  const bgMusic = document.getElementById('bg-music');
  const musicTitle = document.getElementById('music-title');
  const musicIcon = playPauseBtn.querySelector('i');

  playPauseBtn.addEventListener('click', () => {
    if (bgMusic.paused) {
      bgMusic.play();
      musicIcon.className = 'fas fa-pause';
      musicTitle.textContent = 'Música Tocando';
    } else {
      bgMusic.pause();
      musicIcon.className = 'fas fa-play';
      musicTitle.textContent = 'Música Pausada';
    }
  });

  // Script para modo escuro/claro
  const themeToggleBtn = document.getElementById('theme-toggle-btn');
  const body = document.body;

  // Função para aplicar o tema
  function applyTheme(theme) {
    if (theme === 'dark') {
      body.classList.add('dark-mode');
      body.classList.remove('light-mode');
      themeToggleBtn.querySelector('i').className = 'fas fa-sun'; // Ícone de sol para modo escuro
    } else {
      body.classList.add('light-mode');
      body.classList.remove('dark-mode');
      themeToggleBtn.querySelector('i').className = 'fas fa-moon'; // Ícone de lua para modo claro
    }
  }

  // Carregar tema salvo ou usar o padrão (claro)
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    applyTheme(savedTheme);
  } else {
    // Detectar preferência do sistema operacional, se não houver tema salvo
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        applyTheme('dark');
    } else {
        applyTheme('light');
    }
  }

  // Event listener para o botão de alternar tema
  themeToggleBtn.addEventListener('click', () => {
    if (body.classList.contains('dark-mode')) {
      applyTheme('light');
      localStorage.setItem('theme', 'light');
    } else {
      applyTheme('dark');
      localStorage.setItem('theme', 'dark');
    }
  });
</script>
</body>
</html>